var honk=null;Alfresco.WebPreview.prototype.Plugins.HtmlWebPreview=function(e,t){this.wp=e;this.attributes=YAHOO.lang.merge(Alfresco.util.deepCopy(this.attributes),t);return this};Alfresco.WebPreview.prototype.Plugins.HtmlWebPreview.prototype={attributes:{srcMimeType:null},report:function(){},display:function(){var t=this.attributes.srcMimeType?this.attributes.srcMimeType:this.wp.options.mimeType,n=t.replace("/","-");this.getDocument(this.wp.options.nodeRef,t,n);return""},getDocument:function(t,n,r){Alfresco.util.Ajax.request({url:Alfresco.constants.PROXY_URI+"api/node/"+t.replace("://","/")+"/content",responseContentType:"text/html",successCallback:{fn:function(e){this.wp.widgets.previewerElement.innerHTML=" ";var t="";renderToc=this.wp.options.htmlpreviewTocRender,minToc=this.wp.options.htmlpreviewTocMin,maxHlevel=this.wp.options.htmlpreviewTocMaxHeadlineLevel;if(e.serverResponse&&e.serverResponse.status&&e.serverResponse.status==200){t=e.serverResponse.responseText}else{t='<div class="error">'+this.wp.msg("hwp.error.getcontent")+"</div>"}var i=Alfresco.HtmlWebPreviewLib.renderContent(t,n,r,this.wp.msg,renderToc,minToc,maxHlevel);i.appendChild(document.createElement("hr"));this.wp.widgets.previewerElement.appendChild(i)},scope:this},failureCallback:{fn:function(e){this.wp.widgets.previewerElement.innerHTML+='<div class="error">'+this.wp.msg("hwp.error.getcontent")+"</div>"},scope:this},scope:this})}}
